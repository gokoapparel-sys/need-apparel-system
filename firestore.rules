rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // 認証済みユーザーのみアクセス可能
    match /{document=**} {
      allow read, write: if request.auth != null;
    }

    // アイテムコレクション
    match /items/{itemId} {
      allow get: if true; // IDを知っている（または参照として持っている）場合のみ取得可能
      allow list: if request.auth != null; // 一覧取得は認証ユーザーのみ
      allow create, update: if request.auth != null;
      allow delete: if request.auth != null;
    }

    // 生地コレクション
    match /fabrics/{fabricId} {
      allow read: if request.auth != null;
      allow create, update: if request.auth != null;
      allow delete: if request.auth != null;
    }

    // 型紙コレクション
    match /patterns/{patternId} {
      allow read: if request.auth != null;
      allow create, update: if request.auth != null;
      allow delete: if request.auth != null;
    }

    // ブランドコレクション
    match /brands/{brandId} {
      allow read: if request.auth != null;
      allow create, update: if request.auth != null;
      allow delete: if request.auth != null;
    }

    // 展示会コレクション
    match /exhibitions/{exhibitionId} {
      allow read: if request.auth != null;
      allow create, update: if request.auth != null;
      allow delete: if request.auth != null;
    }

    // サンプル貸出コレクション
    match /loans/{loanId} {
      allow get: if true; // 公開ページからID指定取得可能
      allow list: if request.auth != null;
      allow create, update: if request.auth != null;
      allow delete: if request.auth != null;
    }

    // 貸出カード共有コレクション
    match /loanShares/{shareId} {
      allow get: if true; // 公開ページからID指定取得可能（URLを知っている場合）
      allow list: if request.auth != null;
      allow create, update: if request.auth != null;
      allow delete: if request.auth != null;
    }

    // ピックアップコレクション
    match /pickups/{pickupId} {
      allow get: if true; // IDを知っている場合のみ取得可能（URLを知っている）
      allow list: if request.auth != null; // 一覧取得は認証ユーザーのみ
      allow create, update: if request.auth != null;
      allow delete: if request.auth != null;
    }
  }
}
